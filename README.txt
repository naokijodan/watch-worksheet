================================================================================
  Watch Worksheet Generator - 統合版
  FedEx新形式 & DHL形式 完全対応
================================================================================

【フォルダ内容】
  ├── Code.gs           : 統合版Google Apps Scriptコード
  ├── settings.html     : 初期設定用HTMLファイル
  ├── input.html        : データ入力用HTMLファイル
  └── README.txt        : このファイル

================================================================================
【主な機能】
================================================================================

✓ FedEx新形式対応（横型レイアウト、Watch 1～3）
✓ DHL形式対応（縦型レイアウト、2パターン）
✓ 統一されたデータフォーマット（FedEx用のGPTsの出力で両方に対応）
✓ 新項目追加：
  - Quantity（数量）
  - Primary Function（主な機能）
  - Country of Origin of Battery（バッテリー原産国）
  - Movement Size（ムーブメントサイズ）

================================================================================
【セットアップ手順】
================================================================================

1. Google Spreadsheetsを開く
   - 新規または既存のスプレッドシートを開きます

2. スクリプトエディタを開く
   - メニューバー > 拡張機能 > Apps Script

3. ファイルをコピー
   a) Code.gs の内容をコピーして、スクリプトエディタに貼り付け
   b) 左側のファイル一覧で「＋」ボタンをクリック > HTML
   c) 「settings」と名前を付けて、settings.html の内容をコピー
   d) 同様に「input」と名前を付けて、input.html の内容をコピー

4. 保存して実行
   - Ctrl+S（Mac: Cmd+S）で保存
   - スプレッドシートに戻ってリロード
   - メニューバーに「Watch Worksheet」が表示されます

================================================================================
【使用方法】
================================================================================

■ 初回セットアップ
  1. メニュー > Watch Worksheet > 初期設定
  2. 会社情報を入力
     - Company Name（会社名）
     - Name and Title（名前と役職）
     - E-mail（メールアドレス）
  3. 保存ボタンをクリック

■ ワークシート作成
  1. メニュー > Watch Worksheet > 新しいワークシート作成
  2. AWB Number（追跡番号）を入力
  3. ChatGPTから出力されたデータを貼り付け
     ※ 「=== WATCH WORKSHEET DATA ===」から
        「=== END DATA ===」までが含まれている必要があります
  4. 「Watch Worksheet を作成」ボタンをクリック
  5. 新しいシート（NewWatch_日時）が作成されます

■ PDF出力
  【FedEx新形式の場合】
  1. 作成したシート（NewWatch_xxx）を選択
  2. メニュー > Watch Worksheet > 新形式(FedEx)でPDF出力
  3. PDFがGoogle Driveに保存されます（横向き）

  【DHL形式の場合】
  1. 作成したシート（NewWatch_xxx）を選択
  2. メニュー > Watch Worksheet > DHL形式でPDF出力
     または
     メニュー > Watch Worksheet > DHL用ver.2でPDF出力
  3. PDFがGoogle Driveに保存されます（縦向き）

■ PDF出力フォルダ設定（任意）
  1. メニュー > Watch Worksheet > PDF出力用フォルダ設定
  2. フォルダ名を入力（空白でルートフォルダ）

================================================================================
【ChatGPTデータの形式例】
================================================================================

=== WATCH WORKSHEET DATA ===
Style name/No/Reference: Omega Devil Watch Vintage Gold
Total Watch Value: 471.97
Movement Type: Quartz
HTS US Code: 9102.11.4550
Number of Jewels in Movement: 0
Quantity: 1
Material of Band: Leather
Band Detail: Bovine leather
Material of Case: Stainless Steel
Case Detail: NOT Gold/Silver Plated
Material of Backplate: Stainless Steel
Backplate Detail: Stainless Steel
Country of Origin of Movement: Schweiz
Country of Origin of Band: Japan
Country of Origin of Case: Schweiz
Country of Origin of Battery: Japan
Primary Function: Timekeeping
=== END DATA ===

================================================================================
【統合版の特徴】
================================================================================

1. データフォーマットの統一
   - FedEx用のGPTsから出力されたデータで、FedExとDHL両方のフォーマットに対応
   - 新しいフィールド（Quantity, Primary Function, Battery Country）にも対応

2. 柔軟なPDF出力
   - FedEx形式：横向き、複数時計対応（Watch 1～3）
   - DHL形式：縦向き、シンプルなフォーマット
   - DHL用ver.2：より詳細なフォーマット

3. 1つのスプレッドシートで全て完結
   - 同じワークシートから3種類のフォーマットでPDF出力可能
   - フォーマットを切り替えるだけで、異なる運送会社に対応

================================================================================
【注意事項】
================================================================================

1. 新しいワークシート（NewWatch_xxx）を作成後、そのシートから各種PDF出力が可能です

2. 複数の時計を登録する場合
   - FedEx形式：Watch 2～3は手動で入力してください
   - DHL形式：1つの時計のみ対応

3. DHL形式でPDF出力する際
   - 「シートを残しますか？」と聞かれます
   - 通常は「いいえ」を選択して、一時的なDHLシートを削除してください

4. PDF出力時の用紙サイズ
   - FedEx形式：Letter（8.5" x 11"）横向き
   - DHL形式：Letter（8.5" x 11"）縦向き

================================================================================
【トラブルシューティング】
================================================================================

Q: メニューが表示されない
A: スプレッドシートをリロード（F5）してください

Q: 「初期設定が完了していません」と表示される
A: メニュー > Watch Worksheet > 初期設定 から会社情報を登録してください

Q: ChatGPTデータの形式が正しくないと表示される
A: 「=== WATCH WORKSHEET DATA ===」と「=== END DATA ===」が
   含まれているか確認してください

Q: PDF出力時にエラーが発生する
A: シート名が「NewWatch_」で始まっているか確認してください

Q: 設定をリセットしたい
A: メニュー > Watch Worksheet > 設定リセット

================================================================================
【更新履歴】
================================================================================

2025年版 統合版
  - FedEx新形式とDHL形式を1つのコードに統合
  - FedExフォーマットのデータで両方に対応
  - 新項目追加（Quantity, Primary Function, Battery origin, Movement size）
  - データマッピング関数の統一
  - Jewelsフォーマットの統一（"0 to 1 Jewels"）

================================================================================
【バックアップについて】
================================================================================

以下のフォルダは古いバージョンです。統合版に移行後は削除しても構いません：
  - WatchWorksheet_NewFormat（FedEx用の旧版）
  - WatchWorksheet_GAS_DHLv2（DHL用の旧版）

統合版を使用することで、1つのコードで両方のフォーマットに対応できます。

================================================================================
